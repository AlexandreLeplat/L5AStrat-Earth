<app-header></app-header>
<app-menu [selectedRoute]="'map'"></app-menu>
<div ngClass.gt-md="desktop-content"  ngClass.xs="mobile-content" style="margin-top: 20px;" fxLayout="row" fxLayout.xs="column-reverse" fxLayoutWrap fxLayoutGap="0.5%">
    <div class="mapColumn">
        <div class="mapSelector">
            <div class="mapContainer" *ngIf="currentMap && mapTiles else spinnerCard"  fxHide.lt-md>
                <div class="mapContent" fxLayout="column">
                    <div *ngFor="let row of mapTiles" fxLayout="row">
                        <div class="mapTileContainer" *ngFor="let tile of row">
                            <div class="mapTileContent" [style.border-color]="tile.borderColor" [ngClass]="{selected: selectedTile && tile.id == selectedTile.id}"
                                [style.background]="tile.color" (click)="onTileClick(tile, false)">
                                <mat-icon class="icon" [svgIcon]="tile.symbol"></mat-icon>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="mapContainer" *ngIf="currentMap && mapTiles else spinnerCard" fxHide.gt-sm>
                <div #zoomableMap class="mapContent" fxLayout="column">
                    <div *ngFor="let row of mapTiles" fxLayout="row">
                        <div class="mapTileContainer" *ngFor="let tile of row">
                            <div class="mapTileContent" [style.border-color]="tile.borderColor" [ngClass]="{selected: selectedTile && tile.id == selectedTile.id}"
                                [style.background]="tile.color" (click)="onTileClick(tile, true)">
                                <mat-icon class="icon" [svgIcon]="tile.symbol"></mat-icon>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div>
        <div *ngIf="!zoomedIn">
            <mat-card *ngIf="currentMap else spinnerCard" class="title-card">
                <mat-card-content *ngIf="mapsList">
                    <strong>Carte :</strong>
                    <mat-select [(value)]='currentMap' (selectionChange)="selectMap()">
                        <mat-option *ngFor="let map of mapsList" 
                            [value]="map"><b>{{map.name}}</b> [{{currentMap.creationDate | date:'E d MMM H:mm'}}]</mat-option>
                    </mat-select>
                </mat-card-content>
            </mat-card>
        </div>
        <div *ngIf="zoomedIn" class="zoom">
            <button mat-raised-button (click)="zoomOut()">DÃ©zoomer</button>
        </div>
        <mat-card *ngIf="selectedTile" class="description-card">
            <mat-card-header>
                <mat-card-title>{{selectedTile.name}}</mat-card-title>
            </mat-card-header>
            <mat-card-content>
                <mat-list *ngFor="let category of selectedTile.assets | keyvalue">
                    <strong>{{category.key}}</strong>
                    <mat-list-item *ngFor="let asset of category.value | keyvalue">
                      {{asset.key}}<span *ngIf="asset.value && asset.value != ''"> : <span class='value'>{{asset.value}}</span></span>
                      <br>
                    </mat-list-item>
                </mat-list>
            </mat-card-content>
        </mat-card>
    </div>
</div>
<ng-template #spinnerCard>
    <mat-card class="home-card" ngClass.xs="home-card-mobile">
    <mat-card-header>
        <mat-card-title>Chargement...</mat-card-title>
    </mat-card-header>
    <mat-card-content>
        <mat-spinner class="full-width" [style.display]="'block'"></mat-spinner>
    </mat-card-content>
    </mat-card>
</ng-template>  